![output_7_0](https://user-images.githubusercontent.com/50707494/125173866-8d167700-e1fc-11eb-890b-35329ad51198.png)
# Aanalysis of Drinking Data by Country

Data Source: https://github.com/yoonkt200/python-data-analysis<br/>
Analyzed by Narae Kim

"Do South Korea and Canada consume high-intensity alcohol compared to other countries?"


```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

file_path = "./data/drinks.csv"
drinks = pd.read_csv(file_path, engine = "python")
drinks.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 193 entries, 0 to 192
    Data columns (total 6 columns):
     #   Column                        Non-Null Count  Dtype  
    ---  ------                        --------------  -----  
     0   country                       193 non-null    object 
     1   beer_servings                 193 non-null    int64  
     2   spirit_servings               193 non-null    int64  
     3   wine_servings                 193 non-null    int64  
     4   total_litres_of_pure_alcohol  193 non-null    float64
     5   continent                     170 non-null    object 
    dtypes: float64(1), int64(3), object(2)
    memory usage: 9.2+ KB
    


```python
drinks.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>beer_servings</th>
      <th>spirit_servings</th>
      <th>wine_servings</th>
      <th>total_litres_of_pure_alcohol</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>193.000000</td>
      <td>193.000000</td>
      <td>193.000000</td>
      <td>193.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>106.160622</td>
      <td>80.994819</td>
      <td>49.450777</td>
      <td>4.717098</td>
    </tr>
    <tr>
      <th>std</th>
      <td>101.143103</td>
      <td>88.284312</td>
      <td>79.697598</td>
      <td>3.773298</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>20.000000</td>
      <td>4.000000</td>
      <td>1.000000</td>
      <td>1.300000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>76.000000</td>
      <td>56.000000</td>
      <td>8.000000</td>
      <td>4.200000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>188.000000</td>
      <td>128.000000</td>
      <td>59.000000</td>
      <td>7.200000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>376.000000</td>
      <td>438.000000</td>
      <td>370.000000</td>
      <td>14.400000</td>
    </tr>
  </tbody>
</table>
</div>




```python
corr2 = drinks.corr()
corr2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>beer_servings</th>
      <th>spirit_servings</th>
      <th>wine_servings</th>
      <th>total_litres_of_pure_alcohol</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>beer_servings</th>
      <td>1.000000</td>
      <td>0.458819</td>
      <td>0.527172</td>
      <td>0.835839</td>
    </tr>
    <tr>
      <th>spirit_servings</th>
      <td>0.458819</td>
      <td>1.000000</td>
      <td>0.194797</td>
      <td>0.654968</td>
    </tr>
    <tr>
      <th>wine_servings</th>
      <td>0.527172</td>
      <td>0.194797</td>
      <td>1.000000</td>
      <td>0.667598</td>
    </tr>
    <tr>
      <th>total_litres_of_pure_alcohol</th>
      <td>0.835839</td>
      <td>0.654968</td>
      <td>0.667598</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>




```python
mask = np.zeros_like(corr2, dtype = np.bool)
mask[np.triu_indices_from(mask)] = True
```

Correlation Analysis


```python
import seaborn as sns

cols = ['Beer', 'Spirit', 'Wine', 'Alcohol']
sns.set(font_scale = 1.2)
sns.heatmap(corr2, annot = True, fmt = '.2f', mask = mask, square = True, annot_kws = {'size':15}, yticklabels = cols, xticklabels = cols)

plt.tight_layout()
plt.show()
```


    
![png](output_7_0.png)
    


Pair Plot


```python
sns.pairplot(drinks, height = 2.5)
plt.show()
```


    
![png](output_9_0.png)
    


Missing Data Preprocessing


```python
drinks['continent'] = drinks['continent'].fillna('OT') #'OT' means Others
drinks.head(10)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>beer_servings</th>
      <th>spirit_servings</th>
      <th>wine_servings</th>
      <th>total_litres_of_pure_alcohol</th>
      <th>continent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>AS</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Albania</td>
      <td>89</td>
      <td>132</td>
      <td>54</td>
      <td>4.9</td>
      <td>EU</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Algeria</td>
      <td>25</td>
      <td>0</td>
      <td>14</td>
      <td>0.7</td>
      <td>AF</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Andorra</td>
      <td>245</td>
      <td>138</td>
      <td>312</td>
      <td>12.4</td>
      <td>EU</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Angola</td>
      <td>217</td>
      <td>57</td>
      <td>45</td>
      <td>5.9</td>
      <td>AF</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Antigua &amp; Barbuda</td>
      <td>102</td>
      <td>128</td>
      <td>45</td>
      <td>4.9</td>
      <td>OT</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Argentina</td>
      <td>193</td>
      <td>25</td>
      <td>221</td>
      <td>8.3</td>
      <td>SA</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Armenia</td>
      <td>21</td>
      <td>179</td>
      <td>11</td>
      <td>3.8</td>
      <td>EU</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Australia</td>
      <td>261</td>
      <td>72</td>
      <td>212</td>
      <td>10.4</td>
      <td>OC</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Austria</td>
      <td>279</td>
      <td>75</td>
      <td>191</td>
      <td>9.7</td>
      <td>EU</td>
    </tr>
  </tbody>
</table>
</div>



Pie Chart


```python
labels = drinks['continent'].value_counts().index.tolist()
cnts = drinks['continent'].value_counts().values.tolist()
explode = (0, 0, 0, 0.25, 0, 0)

plt.pie(cnts, labels = labels, explode = explode, autopct = "%.0f%%", shadow = True)
plt.show()
```


    
![png](output_13_0.png)
    


Continential Statistical Information


```python
result = drinks.groupby('continent').spirit_servings.agg(['mean', 'min', 'max', 'sum'])
result
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>min</th>
      <th>max</th>
      <th>sum</th>
    </tr>
    <tr>
      <th>continent</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AF</th>
      <td>16.339623</td>
      <td>0</td>
      <td>152</td>
      <td>866</td>
    </tr>
    <tr>
      <th>AS</th>
      <td>60.840909</td>
      <td>0</td>
      <td>326</td>
      <td>2677</td>
    </tr>
    <tr>
      <th>EU</th>
      <td>132.555556</td>
      <td>0</td>
      <td>373</td>
      <td>5965</td>
    </tr>
    <tr>
      <th>OC</th>
      <td>58.437500</td>
      <td>0</td>
      <td>254</td>
      <td>935</td>
    </tr>
    <tr>
      <th>OT</th>
      <td>165.739130</td>
      <td>68</td>
      <td>438</td>
      <td>3812</td>
    </tr>
    <tr>
      <th>SA</th>
      <td>114.750000</td>
      <td>25</td>
      <td>302</td>
      <td>1377</td>
    </tr>
  </tbody>
</table>
</div>



Continents that consume more alcohol than average


```python
total_mean = drinks.total_litres_of_pure_alcohol.mean()
continent_mean = drinks.groupby('continent')['total_litres_of_pure_alcohol'].mean()
continent_over_mean = continent_mean[continent_mean > total_mean]
continent_over_mean
```




    continent
    EU    8.617778
    OT    5.995652
    SA    6.308333
    Name: total_litres_of_pure_alcohol, dtype: float64




```python
beer_continent = drinks.groupby('continent').beer_servings.mean().idxmax()
beer_continent
```




    'EU'




```python
n = len(result.index)
means = result['mean'].tolist()
mins = result['min'].tolist()
maxs = result['max'].tolist()
sums = result['sum'].tolist()

index = np.arange(n)
bar_width = 0.2

plt.bar(index, means, bar_width, color = 'r', label = 'Mean')
plt.bar(index + bar_width, mins, bar_width, color = 'g', label = 'Min')
plt.bar(index + bar_width * 2, maxs, bar_width, color = 'b', label = 'Max')
plt.bar(index + bar_width * 3, sums, bar_width, color = 'y', label = 'Sum')

plt.xticks(index, result.index.tolist())
plt.legend()
plt.show()
```


    
![png](output_19_0.png)
    


Total alcohol consumption by continent


```python
continents = continent_mean.index.tolist()
continents.append('Mean')
x_pos = np.arange(len(continents))
alcohol = continent_mean.tolist()
alcohol.append(total_mean)

bar_list = plt.bar(x_pos, alcohol, align = 'center', alpha = 0.5)
bar_list[len(continents) - 1].set_color('r')
plt.xticks(x_pos, continents)
plt.plot([0, 6], [total_mean, total_mean], 'k--')

plt.ylabel('Total_litres_of_pure_alcohol')
plt.title('Total_litres_of_pure_alcohol by Continent')
plt.show()
```


    
![png](output_21_0.png)
    


The beer comsumption by Continent


```python
beer_group = drinks.groupby('continent')['beer_servings'].sum()
continents = beer_group.index.tolist()
x_pos = np.arange(len(continents))
alcohol = beer_group.tolist()

bar_list = plt.bar(x_pos, alcohol, align = 'center', alpha = 0.5)
bar_list[continents.index('EU')].set_color('r')

plt.xticks(x_pos, continents)
plt.ylabel('beer_servings')
plt.title('beer_servings by Continent')
plt.show()
```


    
![png](output_23_0.png)
    


T-test

Result: The difference in beer consumption between Africa and Europe is statistically significant.

Note: Reliability is not high because data size are different between groups and normal distribution cannot be assured.


```python
from scipy import stats

africa = drinks.loc[drinks['continent'] == 'AF']
europe = drinks.loc[drinks['continent'] == 'EU']

tTestResult = stats.ttest_ind(africa['beer_servings'], europe['beer_servings'])
tTestResultDiffVar = stats.ttest_ind(africa['beer_servings'], europe['beer_servings'], equal_var = False)

print('t-statistic: %.3f, p-value: %.3f(Assuming Equal Variances)'%tTestResult)
print('t-statistic: %.3f, p-value: %.3f(Assuming Unequal Variances)'%tTestResultDiffVar)
```

    t-statistic: -7.268, p-value: 0.000(Assuming Equal Variances)
    t-statistic: -7.144, p-value: 0.000(Assuming Unequal Variances)
    

Analysis of whether South Korea and Canada consume high-intensity alcohol compared to other countries


```python
drinks['total_servings'] = drinks['beer_servings'] + drinks['spirit_servings'] + drinks['wine_servings']

#Rate of alcohol compared to amount
drinks['alcohol_rate'] = drinks['total_litres_of_pure_alcohol'] / drinks['total_servings']
drinks['alcohol_rate'] = drinks['alcohol_rate'].fillna(0)

country_with_rank = drinks[['country', 'alcohol_rate']]
country_with_rank = country_with_rank.sort_values(by = 'alcohol_rate', ascending = False)
country_with_rank
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>alcohol_rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>63</th>
      <td>Gambia</td>
      <td>0.266667</td>
    </tr>
    <tr>
      <th>153</th>
      <td>Sierra Leone</td>
      <td>0.223333</td>
    </tr>
    <tr>
      <th>124</th>
      <td>Nigeria</td>
      <td>0.185714</td>
    </tr>
    <tr>
      <th>179</th>
      <td>Uganda</td>
      <td>0.153704</td>
    </tr>
    <tr>
      <th>142</th>
      <td>Rwanda</td>
      <td>0.151111</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>103</th>
      <td>Maldives</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>97</th>
      <td>Libya</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>79</th>
      <td>Iran</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Kuwait</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
<p>193 rows Ã— 2 columns</p>
</div>



Rank by country for rate of alcohol compared to amount


```python
country = country_with_rank.country.tolist()
rank = country_with_rank.alcohol_rate.tolist()

x_pos = np.arange(len(country))

bar = plt.bar(x_pos, rank)
bar[country.index('South Korea')].set_color('b')
bar[country.index('Canada')].set_color('r')

plt.ylabel('Alcohol Rate')
plt.title('Liquor drink rank By Country')
plt.axis([0, 200, 0, 0.3])

korea_rank = country.index('South Korea')
korea_alc_rate = country_with_rank[country_with_rank['country'] == 'South Korea']['alcohol_rate'].values[0]

canada_rank = country.index('Canada')
canada_alc_rate = country_with_rank[country_with_rank['country'] == 'Canada']['alcohol_rate'].values[0]

plt.annotate('South Korea: ' + str(korea_rank + 1), xy = (korea_rank, korea_alc_rate),
             xytext = (korea_rank + 10, korea_alc_rate + 0.05), arrowprops = dict(facecolor = 'blue', shrink = 0.05))
plt.annotate('Canada: ' + str(canada_rank + 1), xy = (canada_rank, canada_alc_rate),
             xytext = (canada_rank + 10, canada_alc_rate + 0.05), arrowprops = dict(facecolor = 'red', shrink = 0.05))
plt.show()
```


    
![png](output_29_0.png)
    


Result

1. South Korea consumes high-intensity alcohol compared to other countries.(15th out of 193 countries)

2. Canada consumes low-intensity alcohol compared to other countries.(137th out of 193 countries)

3. Alcohol consumption in most countries is mostly due to beer.

4. Europe has the highest beer consumption.

5. The difference in beer consumption between Africa and Europe is statistically significant based on T-test.<br/>(reliability is not high because data size are different between groups and normal distribution cannot be assured)
